# Note: build this package with --force flag
# Note: keep insync with lib32-mesa pkg
#
# maintainer: Philip MÃ¼ller <philm[at]manjaro[dog]org>
# maintainer: Roland Singer <roland[at]manjaro[dog]org>

pkgname=('lib32-libgl')
pkgver=9.0
pkgrel=1
arch=('x86_64')
depends=('mhwd' 'lib32-libdrm>=2.4.39' 'lib32-libxxf86vm>=1.1.2' 'lib32-libxdamage>=1.1.3' 'lib32-expat>=2.1.0' 'lib32-libglapi'
           'libgl')
pkgdesc="Mesa 3-D graphics library and DRI software rasterizer (32-bit)"
# currently disabled so force the remove
conflicts=('lib32-libgbm')
replace=('lib32-libgbm')
install=libgl.install
url="http://mesa3d.sourceforge.net"
license=('custom')
#options=('!buildflags')
source=(http://mirror.us.leaseweb.net/archlinux/multilib/os/$CARCH/$pkgname-$pkgver-$pkgrel-$CARCH.pkg.tar.xz)
sha256sums=('d2cd5365dcc9c4d5c1a5500e3f1a97cb2714c52588953b8894ea03fbab4d44a6')

package() {
  cp -rPf usr ${pkgdir}
  mv "${pkgdir}/usr/lib32/libGL.so.1.2.0" "${pkgdir}/usr/lib32/libGL.so.mesa"
  rm "${pkgdir}/usr/lib32/libGL.so.1"
  rm "${pkgdir}/usr/lib32/libGL.so"
  # rm "${pkgdir}/usr/lib32/xorg/modules/extensions/libglx.so"
}
